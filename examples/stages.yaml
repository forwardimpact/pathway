# Stages - What part of the lifecycle?
#
# Defines the three stages of the engineering lifecycle with their tools,
# handoffs, and constraints. Used for both human checklists and AI agent
# profile generation.
#
# Entry criteria define what must be complete before starting work in a stage.
# Exit criteria are implicit: they equal the entry criteria of the next stage.
#
# See concept/lifecycle.md for full documentation.

- id: plan
  name: Plan
  emoji: "ðŸ“‹"
  description:
    Spec-Driven Planning - Specification is the source of truth; code serves the spec
  handoffs:
    - targetStage: code
      label: Start Coding
      prompt: Implement the planned changes.
  constraints:
    - Do not make code edits or execute commands
    - Specify first (what and why), then plan (how)
    - Write specs and plans as markdown files under specs/[feature-name]/
    - Stop and ask the user when requirements are unclear; do not guess
  entryCriteria: [] # Entry stage, no prior work expected

- id: code
  name: Code
  emoji: "ðŸ’»"
  description: Build & Iterate - Implement, test, refine
  handoffs:
    - targetStage: review
      label: Request Review
      prompt: Review the implemented changes.
  constraints:
    - Implement one task at a time, verify before moving on
    - Write tests alongside implementation
  entryCriteria:
    - Problem statement documented
    - Approach selected with rationale
    - Implementation plan exists

- id: review
  name: Review
  emoji: "âœ…"
  description: Verify & Ship - Review, approve, deploy, document
  handoffs:
    - targetStage: code
      label: Request Changes
      prompt: Address the review feedback.
    - targetStage: plan
      label: Needs Replanning
      prompt: The implementation needs replanning.
  constraints:
    - Do not make code edits
    - Prioritize actionable feedback over exhaustive lists
  entryCriteria:
    - Implementation complete
    - Tests written and passing
    - Self-review completed
